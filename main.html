<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!--link rel="icon" href="../../favicon.ico"-->

    <title>CloudNotes</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">

    <!-- Custom styles for this template -->
    <link href="theme.css" rel="stylesheet">


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script src="http://www.parsecdn.com/js/parse-1.3.3.min.js"></script>


    <script src="./handlebars-v2.0.0.js"></script>



    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!--<script src="../../assets/js/ie-emulation-modes-warning.js"></script>-->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body role="document">


    <div class="container theme-showcase" role="main">

      <!-- Main jumbotron for a primary marketing message or call to action -->
      <div class="jumbotron">
        <h1>CloudNotes</h1>
        <p>Share activities with the world</p>
        <p id="loginStatus"></p>
      </div>

      <div class="row">
        <div class="col-sm-6">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title">Post a Note</h3>
            </div>
            <div class="panel-body">
              <p>Choose activity
                <select id="activity">
                  <option value="Run">Run</option>
                  <option value="Yoga">Yoga</option>
                  <option value="Study">Study</option>
                </select>
              </p>
              <p>
                Enter value:
                <input type="number" name="aValue" id="aValue" value="0.0">
              </p>
              <button id="submit" type="button">Submit</button>
            </div>
          </div>


        </div><!-- /.col-sm-6 -->
        <div class="col-sm-6">
          <div class="panel panel-success">
            <div class="panel-heading">
              <h3 class="panel-title">Check Activity</h3>
            </div>
            <div class="panel-body">
              <table class="table table-hover">
                <caption>Submitted activities</caption>
                <thead>
                  <tr>
                    <th>Activity</th>
                    <th>Value</th>
                  </tr>
                </thead>
                <tbody id="activitiesList">
                  <tr>
                    <td>Tanmay</td>
                    <td>Bangalore</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

        </div><!-- /.col-sm-4 -->
      </div>

    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <script>
      $(document).ready(function {
        window.fbAsyncInit = function() {
          FB.init({
            appId      : '1038197856196826',
            xfbml      : true,
            version    : 'v2.2'
          });
        };

        (function(d, s, id){
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) {return;}
          js = d.createElement(s); js.id = id;
          js.src = "//connect.facebook.net/en_US/sdk.js";
          fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));

        FB.api('/me', function(response) {
          console.log('Successful login for: ' + response.name);
          document.getElementById('loginStatus').innerHTML =
          'Hello, ' + response.name + '!';
        });
      });
    </script>

    <script id="activityTempla" type="text/x-handlebars-template">
      <tr>
        <td>{{activity}}</td>
        <td>{{aValue}}</td>
      </tr>
    </script>

    <script>
      Parse.initialize("MBORYJfvz1E3qi2aiC4GbwFIKI1XuWI17PCzmFGJ", "8cftrKDpjrPQ73G1yTQeEpZ0RIqPPKXX36K6c2S2");

      $(document).ready(function() {
          getActivity();
      });

      function getActivity() {
        var Activity = Parse.Object.extend("Activity");
        var query = new Parse.Query(Activity);

        query.find({
          success: function(results) {
            $("#activitiesList").html("");
            var template = Handlebars.compile($("#activityTempla").html());

            $(results).each(function(i,e) {
              var q = e.toJSON();
              $("#activitiesList").append(template(q));
            })

          },
          error: function(error) {
            console.log(error.message);
          }
        });

      }


      function saveActivity(data) {
        var Activity = Parse.Object.extend("Activity");
        var activity = new Activity();

        activity.set("activity", data.activity);
        activity.set("aValue", data.aValue);

        activity.save(null, {
          success: function () {
            console.log("Successfully saved " + data.activity + " " + data.aValue);
            getActivity();
          },
          error: function (activity, error) {
            console.log(error.message);
          }
        });

      }

      $( "#submit" ).click(function() {
        var data = {
          activity: $("#activity option:selected").text(),
          aValue: $("#aValue").val()
        };
        saveActivity(data);
      });


    </script>
  </body>
</html>
